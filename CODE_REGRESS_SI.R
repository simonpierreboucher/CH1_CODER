load("~/Desktop/codeR_CH1/BD_SI_COT.Rda")
load("~/Desktop/codeR_CH1/BD_SI_PC.Rda")
X<-X_PC
X[is.na(X)] <- 0


X_R<-X[ which(X$SURPRISE_S1!=0 | X$SURPRISE_S2!=0 | X$SURPRISE_S3!=0 | X$SURPRISE_S4!=0 | X$SURPRISE_S5!=0 | X$SURPRISE_S6!=0| X$SURPRISE_S7!=0| X$SURPRISE_S8!=0| X$SURPRISE_S9!=0| X$SURPRISE_S10!=0| X$SURPRISE_S11!=0| X$SURPRISE_S12!=0| X$SURPRISE_S13!=0| X$SURPRISE_S14!=0| X$SURPRISE_S15!=0| X$SURPRISE_S16!=0| X$SURPRISE_S17!=0| X$SURPRISE_S18!=0| X$SURPRISE_S19!=0| X$SURPRISE_S20!=0| X$SURPRISE_S21!=0| X$SURPRISE_S22!=0),]
regress_OLS<-lm(r_t1~SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22+r_m1, data= X_R)

regress2_OLS<-lm(r_t1~(SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22)*MSCT+r_m1, data= X_R)

regress3_OLS<-lm(r_t1~(SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22)*NLS+r_m1, data= X_R)

regress4_OLS<-lm(r_t1~(SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22)*WT+r_m1, data= X_R)


X <- X[order(X$YEAR, X$MONTH,X$DAY,X$t),]

X$HOUR.f<-factor(X$HOUR)




regress<-lm(r_t1~SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22+r_m1, data= X)

w <- numeric(length = length(regress$residuals))
w[1]<-abs(regress$residuals[1])
for (i in seq_along(regress$residuals)) {
  w[i+1] <- 0.1*abs(regress$residuals[i+1]) + 0.9*w[i]
}
w<-w[1:i]
regress.weights<-1/(w^2)

regress_wls <-lm(r_t1~SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22+r_m1, data=X , 
                    weights = regress.weights)




regress2<-lm(r_t1~(SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22)*MSCT+r_m1, data= X)
w <- numeric(length = length(regress2$residuals))
w[1]<-abs(regress2$residuals[1])
for (i in seq_along(regress2$residuals)) {
  w[i+1] <- 0.1*abs(regress2$residuals[i+1]) + 0.9*w[i]
}
w<-w[1:i]
regress.weights2<-1/(w^2)



regress_wls2 <-lm(r_t1~(SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22)*MSCT+r_m1, data= X, 
                     weights = regress.weights2)




regress3<-lm(r_t1~(SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22)*NLS+r_m1, data= X)
w <- numeric(length = length(regress3$residuals))
w[1]<-abs(regress3$residuals[1])
for (i in seq_along(regress3$residuals)) {
  w[i+1] <- 0.1*abs(regress3$residuals[i+1]) + 0.9*w[i]
}
w<-w[1:i]
regress.weights3<-1/(w^2)
regress_wls3 <-lm(r_t1~(SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22)*NLS+r_m1, data= X, 
                     weights = regress.weights3)


regress4<-lm(r_t1~(SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22)*WT+r_m1, data= X)
w <- numeric(length = length(regress4$residuals))
w[1]<-abs(regress4$residuals[1])
for (i in seq_along(regress4$residuals)) {
  w[i+1] <- 0.1*abs(regress4$residuals[i+1]) + 0.9*w[i]
}
w<-w[1:i]
regress.weights4<-1/(w^2)

regress_wls4 <-lm(r_t1~(SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22)*WT+r_m1, data= X, 
                     weights = regress.weights4)


regress<-lm(r_t1~SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22+r_m1, data= X)
regress.weights5 <- 1 / (fitted(lm(abs(regress2$residuals) ~ SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22+HOUR.f,data = X)))^2
regress_wls5 <-lm(r_t1~SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22+r_m1, data= X, 
                     weights = regress.weights5)


regress2<-lm(r_t1~(SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22)*MSCT+r_m1, data= X)
regress.weights6 <- 1 / (fitted(lm(abs(regress2$residuals) ~ SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22+HOUR.f,data = X)))^2
regress_wls6 <-lm(r_t1~(SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22)*MSCT+r_m1, data= X, 
                     weights = regress.weights6)



regress3<-lm(r_t1~(SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22)*NLS+r_m1, data= X)
regress.weights7 <- 1 / (fitted(lm(abs(regress2$residuals) ~ SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22+HOUR.f,data = X)))^2
regress_wls7 <-lm(r_t1~(SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22)*NLS+r_m1, data= X, 
                     weights = regress.weights7)


regress4<-lm(r_t1~(SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22)*WT+r_m1, data= X)
regress.weights8 <- 1 / (fitted(lm(abs(regress4$residuals) ~ SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22+HOUR.f,data = X)))^2
regress_wls8 <-lm(r_t1~(SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22)*WT+r_m1, data= X, 
                     weights = regress.weights8)




stargazer(regress_OLS,regress_wls,regress_wls5, title="Results", align=TRUE,single.row=TRUE,no.space=TRUE,type = "text")

stargazer(regress2_OLS,regress_wls2,regress_wls6, title="Results", align=TRUE,single.row=TRUE,no.space=TRUE,type = "text")

stargazer(regress3_OLS,regress_wls3,regress_wls7, title="Results", align=TRUE,single.row=TRUE,no.space=TRUE,type = "text")

stargazer(regress4_OLS,regress_wls4,regress_wls8, title="Results", align=TRUE,single.row=TRUE,no.space=TRUE,type = "text")


X$S1<-ifelse(X$SURPRISE_S1==0,0,1)
X$S2<-ifelse(X$SURPRISE_S2==0,0,1)
X$S3<-ifelse(X$SURPRISE_S3==0,0,1)
X$S4<-ifelse(X$SURPRISE_S4==0,0,1)
X$S5<-ifelse(X$SURPRISE_S5==0,0,1)
X$S6<-ifelse(X$SURPRISE_S6==0,0,1)
X$S7<-ifelse(X$SURPRISE_S7==0,0,1)
X$S8<-ifelse(X$SURPRISE_S8==0,0,1)
X$S9<-ifelse(X$SURPRISE_S9==0,0,1)
X$S10<-ifelse(X$SURPRISE_S10==0,0,1)
X$S11<-ifelse(X$SURPRISE_S11==0,0,1)
X$S12<-ifelse(X$SURPRISE_S12==0,0,1)
X$S13<-ifelse(X$SURPRISE_S13==0,0,1)
X$S14<-ifelse(X$SURPRISE_S14==0,0,1)
X$S15<-ifelse(X$SURPRISE_S15==0,0,1)
X$S16<-ifelse(X$SURPRISE_S16==0,0,1)
X$S17<-ifelse(X$SURPRISE_S17==0,0,1)
X$S18<-ifelse(X$SURPRISE_S18==0,0,1)
X$S19<-ifelse(X$SURPRISE_S19==0,0,1)
X$S20<-ifelse(X$SURPRISE_S20==0,0,1)
X$S21<-ifelse(X$SURPRISE_S21==0,0,1)
X$S22<-ifelse(X$SURPRISE_S22==0,0,1)


regress<-lm(r_t1~SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22+r_m1, data= X)
VOL1<-lm(abs(regress$residuals) ~(S1+S2+S3+S4+S5+S6+S7+S8+S9+S10+S11+S12+S13+S14+S15+S16+S17+S18+S19+S20+S21+S22)*MSCT+HOUR.f,data = X)
VOL2<-lm(abs(regress$residuals) ~(S1+S2+S3+S4+S5+S6+S7+S8+S9+S10+S11+S12+S13+S14+S15+S16+S17+S18+S19+S20+S21+S22)*NLS+HOUR.f,data = X)
VOL3<-lm(abs(regress$residuals) ~(S1+S2+S3+S4+S5+S6+S7+S8+S9+S10+S11+S12+S13+S14+S15+S16+S17+S18+S19+S20+S21+S22)*WT+HOUR.f,data = X)


stargazer(VOL1, title="Results", align=TRUE,single.row=TRUE,no.space=TRUE,type = "text")
stargazer(VOL2, title="Results", align=TRUE,single.row=TRUE,no.space=TRUE,type = "text")
stargazer(VOL3, title="Results", align=TRUE,single.row=TRUE,no.space=TRUE,type = "text")


X<-X_COT
X[is.na(X)] <- 0


X <- X[order(X$YEAR, X$MONTH,X$DAY,X$t),]

X$HOUR.f<-factor(X$HOUR)


regress3<-lm(r_t1~(SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22)*MM_NLS+r_m1, data= X)
w <- numeric(length = length(regress3$residuals))
w[1]<-abs(regress3$residuals[1])
for (i in seq_along(regress3$residuals)) {
  w[i+1] <- 0.1*abs(regress3$residuals[i+1]) + 0.9*w[i]
}
w<-w[1:i]
regress.weights3<-1/(w^2)
regress_wls3_mm <-lm(r_t1~(SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22)*MM_NLS+r_m1, data= X, 
                     weights = regress.weights3)

regress3<-lm(r_t1~(SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22)*SWAP_NLS+r_m1, data= X)
w <- numeric(length = length(regress3$residuals))
w[1]<-abs(regress3$residuals[1])
for (i in seq_along(regress3$residuals)) {
  w[i+1] <- 0.1*abs(regress3$residuals[i+1]) + 0.9*w[i]
}
w<-w[1:i]
regress.weights3<-1/(w^2)
regress_wls3_swap <-lm(r_t1~(SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22)*SWAP_NLS+r_m1, data= X, 
                       weights = regress.weights3)

regress3<-lm(r_t1~(SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22)*MM_NLS+r_m1, data= X)
regress.weights7 <- 1 / (fitted(lm(abs(regress2$residuals) ~ SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22+HOUR.f,data = X)))^2
regress_wls7_mm <-lm(r_t1~(SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22)*MM_NLS+r_m1, data= X, 
                  weights = regress.weights7)



regress3<-lm(r_t1~(SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22)*SWAP_NLS+r_m1, data= X)
regress.weights7 <- 1 / (fitted(lm(abs(regress2$residuals) ~ SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22+HOUR.f,data = X)))^2
regress_wls7_swap <-lm(r_t1~(SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22)*SWAP_NLS+r_m1, data= X, 
                     weights = regress.weights7)

stargazer(regress_wls3_mm,regress_wls3_swap,regress_wls7_mm,regress_wls7_swap, title="Results", align=TRUE,single.row=TRUE,no.space=TRUE,type = "text")



X$S1<-ifelse(X$SURPRISE_S1==0,0,1)
X$S2<-ifelse(X$SURPRISE_S2==0,0,1)
X$S3<-ifelse(X$SURPRISE_S3==0,0,1)
X$S4<-ifelse(X$SURPRISE_S4==0,0,1)
X$S5<-ifelse(X$SURPRISE_S5==0,0,1)
X$S6<-ifelse(X$SURPRISE_S6==0,0,1)
X$S7<-ifelse(X$SURPRISE_S7==0,0,1)
X$S8<-ifelse(X$SURPRISE_S8==0,0,1)
X$S9<-ifelse(X$SURPRISE_S9==0,0,1)
X$S10<-ifelse(X$SURPRISE_S10==0,0,1)
X$S11<-ifelse(X$SURPRISE_S11==0,0,1)
X$S12<-ifelse(X$SURPRISE_S12==0,0,1)
X$S13<-ifelse(X$SURPRISE_S13==0,0,1)
X$S14<-ifelse(X$SURPRISE_S14==0,0,1)
X$S15<-ifelse(X$SURPRISE_S15==0,0,1)
X$S16<-ifelse(X$SURPRISE_S16==0,0,1)
X$S17<-ifelse(X$SURPRISE_S17==0,0,1)
X$S18<-ifelse(X$SURPRISE_S18==0,0,1)
X$S19<-ifelse(X$SURPRISE_S19==0,0,1)
X$S20<-ifelse(X$SURPRISE_S20==0,0,1)
X$S21<-ifelse(X$SURPRISE_S21==0,0,1)
X$S22<-ifelse(X$SURPRISE_S22==0,0,1)


regress<-lm(r_t1~SURPRISE_S1+SURPRISE_S2+SURPRISE_S3+SURPRISE_S4+SURPRISE_S5+SURPRISE_S6+SURPRISE_S7+SURPRISE_S8+SURPRISE_S9+SURPRISE_S10+SURPRISE_S11+SURPRISE_S12+SURPRISE_S13+SURPRISE_S14+SURPRISE_S15+SURPRISE_S16+SURPRISE_S17+SURPRISE_S18+SURPRISE_S19+SURPRISE_S20+SURPRISE_S21+SURPRISE_S22+r_m1, data= X)

VOL2_MM<-lm(abs(regress$residuals) ~(S1+S2+S3+S4+S5+S6+S7+S8+S9+S10+S11+S12+S13+S14+S15+S16+S17+S18+S19+S20+S21+S22)*MM_NLS+HOUR.f,data = X)
VOL2_SWAP<-lm(abs(regress$residuals) ~(S1+S2+S3+S4+S5+S6+S7+S8+S9+S10+S11+S12+S13+S14+S15+S16+S17+S18+S19+S20+S21+S22)*SWAP_NLS+HOUR.f,data = X)

stargazer(VOL2_MM, title="Results", align=TRUE,single.row=TRUE,no.space=TRUE,type = "text")
stargazer(VOL2_SWAP, title="Results", align=TRUE,single.row=TRUE,no.space=TRUE,type = "text")


